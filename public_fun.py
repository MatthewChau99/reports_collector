import datetime
import json
import os
from lxml import etree

import config


def calc_date(e_date):
    """
    过滤函数时间,计算输入时间与config.S_TIME时间相差天数
    :param e_date:
    :return:
    """
    try:
        s_date = config.S_TIME
        s_date = datetime.datetime.strptime(s_date, "%Y-%m-%d")
        e_date = datetime.datetime.strptime(e_date, "%Y-%m-%d")
        day = e_date - s_date
    except:
        return True
    return True if day.days > 0 else False


def filter_space_json(text_list):
    """
    清楚标签内容的\n \t \r 空格等无用字符
    :param text_list:
    :return: str
    """
    text = ''.join(a for a in text_list if a.split() != [])
    return text


def filter_space_html(text_list):
    """
    将element转换成标签并出去\n \t \r等无用字符
    :param text_list: 网页标签element
    :return: 解析处理后的网页标签 eg: [div<..........>, .....]
    """
    result = []
    for h in text_list:
        h2 = etree.tostring(h, method='html', encoding='utf-8')
        h3 = ' '.join(h2.decode('utf-8').split())
        result.append(h3)
    return result


def write_down_html(path, filename, text):
    """
    数据保存
    :param filename: 文件名 xxx.html
    :param path:路径
    :param text: 保存内容 [label1, label2,...]
    :return:
    """
    if not os.path.isdir(path):
        os.makedirs(path)
    with open(os.path.join(path, filename), 'a', encoding='utf-8') as f:
        for t in text:
            f.write(t + '\n')


def write_down_json(path, filename, text):
    """
    数据保存
    :param filename: 文件名
    :param path:路径
    :param text: 保存内容
    :return:
    """
    if not os.path.isdir(path):
        os.makedirs(path)
    with open(os.path.join(path, filename), 'w', encoding='utf-8') as f:
        f.write(json.dumps(text, indent=3, ensure_ascii=False))


if __name__ == '__main__':
    a = [
        b'<divid="post_description">\r\n\t\t\t\t\t\t<pstyle="text-align:left;">&#36817;&#26085;&#65292;&#38543;&#30528;&#20840;&#29699;&#39318;&#25903;<ahref="https://www.iyiou.com/t/rengongzhineng/"title="&#20154;&#24037;&#26234;&#33021;"target="_blank">&#20154;&#24037;&#26234;&#33021;</a>MV&#22312;&#24320;&#24149;&#24335;&#21809;&#21709;&#65292;2020&#24180;<ahref="https://www.iyiou.com/t/shijierengongzhinengdahui/"title="&#19990;&#30028;&#20154;&#24037;&#26234;&#33021;&#22823;&#20250;"target="_blank">&#19990;&#30028;&#20154;&#24037;&#26234;&#33021;&#22823;&#20250;</a>&#65288;WAIC&#65289;&#27491;&#24335;&#25289;&#24320;&#24119;&#24149;&#12290;</p>\n<pstyle="text-align:left;">&#24320;&#24149;&#24335;&#29616;&#22330;&#65292;&#38500;&#20102;AI&#22899;&#22242;&#20986;&#36947;&#65292;&#19977;&#8220;&#39532;&#8221;&#20108;&#8220;&#23439;&#8221;&#21516;&#21488;&#24341;&#36215;&#28909;&#35758;&#22806;&#65292;&#26412;&#27425;&#22823;&#20250;&#30340;&#32447;&#19979;&#26426;&#22120;&#20154;&#29305;&#23637;&#20063;&#24341;&#20154;&#27880;&#30446;&#12290;&#19978;&#28023;&#26377;&#20010;&#26426;&#22120;&#20154;&#26377;&#38480;&#20844;&#21496;&#65288;&#31616;&#31216;YOGOROBOT&#65289;&#21463;&#19978;&#28023;&#32463;&#20449;&#22996;&#36992;&#35831;&#65292;&#22312;&#24320;&#24149;&#24335;&#19978;&#21457;&#24067;&#20102;&#26368;&#26032;&#30340;&#26234;&#33021;&#26411;&#31471;&#37197;&#36865;&#31449;&#65292;&#23427;&#20026;&#27004;&#23431;&#25552;&#20379;&#39640;&#25928;&#20415;&#25463;&#30340;&#26080;&#25509;&#35302;&#37197;&#36865;&#26381;&#21153;&#65292;&#23558;AI&#20154;&#24037;&#26234;&#33021;&#24212;&#29992;&#21040;&#20154;&#20204;&#30340;&#26085;&#24120;&#29983;&#27963;&#20013;&#65292;&#22312;&#29616;&#22330;&#26025;&#33719;&#20102;&#23186;&#20307;&#35266;&#20247;&#30340;&#19968;&#33268;&#22909;&#35780;&#12290;</p>\n<h3style="text-align:left;">&#33258;&#20027;&#21487;&#25511;&#26032;&#25216;&#26415;&#65292;&#24320;&#21551;<ahref="https://www.iyiou.com/t/wurenpeisong/"title="&#26080;&#20154;&#37197;&#36865;"target="_blank">&#26080;&#20154;&#37197;&#36865;</a>&#26032;&#20307;&#39564;</h3>\n<pstyle="text-align:left;">&#26426;&#22120;&#20154;&#36865;&#22806;&#21334;&#24050;&#32463;&#36880;&#28176;&#25104;&#20026;&#19978;&#28023;&#20889;&#23383;&#27004;&#30333;&#39046;&#29983;&#27963;&#30340;&#19968;&#37096;&#20998;&#65292;&#25454;YOGO&#160;ROBOT&#30340;&#32852;&#21512;&#21019;&#22987;&#20154;&#24352;&#38451;&#26032;&#20171;&#32461;&#65292;&#20182;&#20204;&#30340;&#26234;&#33021;&#26411;&#31471;&#37197;&#36865;&#31995;&#32479;&#24050;&#32463;&#22312;&#38470;&#23478;&#22068;&#12289;&#24464;&#23478;&#27719;&#12289;&#38745;&#23433;&#12289;&#34425;&#26725;&#31561;&#29255;&#21306;&#36880;&#27493;&#24418;&#25104;&#26080;&#20154;&#21270;&#31449;&#28857;&#65292;&#36827;&#20837;&#20840;&#22269;150&#22810;&#26635;&#27004;&#23431;&#37324;&#25237;&#20837;&#20351;&#29992;&#12290;</p>\n<pstyle="text-align:left;">&#32487;2019&#24180;&#22312;&#19990;&#30028;&#20154;&#24037;&#26234;&#33021;&#22823;&#20250;&#21457;&#24067;&#26368;&#26032;&#37197;&#36865;&#26426;&#22120;&#20154;&#20043;&#21518;&#65292;YOGOROBOT&#22312;&#20170;&#24180;&#30340;WAIC&#24320;&#24149;&#24335;&#19978;&#24102;&#26469;&#20102;&#20182;&#20204;&#20840;&#26032;&#30340;&#26234;&#33021;&#26411;&#31471;&#37197;&#36865;&#31449;&#12290;&#23427;&#21253;&#25324;&#26234;&#33021;&#26426;&#22120;&#20154;&#12289;AloT&#31995;&#32479;&#12289;&#25968;&#26234;&#21270;&#31649;&#29702;&#24179;&#21488;&#21644;&#25968;&#25454;&#35843;&#24230;&#20013;&#24515;&#65292;&#21487;&#20026;&#27004;&#23431;&#25552;&#20379;&#37197;&#36865;&#12289;<ahref="https://www.iyiou.com/t/xinlingshou/"title="&#26032;&#38646;&#21806;"target="_blank">&#26032;&#38646;&#21806;</a>&#12289;&#23433;&#38450;&#28040;&#27602;&#31561;&#20010;&#24615;&#21270;&#26381;&#21153;&#12290;</p>\n<pstyle="text-align:left;">&#22806;&#21334;&#23567;&#21733;&#21482;&#38656;&#35201;&#24405;&#20837;&#29992;&#25143;&#25163;&#26426;&#21495;&#21644;&#27004;&#23618;&#20449;&#24687;&#65292;&#25226;&#21253;&#35065;&#25918;&#20837;&#26234;&#33021;&#26411;&#31471;&#37197;&#36865;&#31449;&#30340;&#24405;&#21333;&#21475;&#21363;&#21487;&#31163;&#24320;&#12290;&#20113;&#31471;&#20250;&#36890;&#30693;&#26426;&#26800;&#25163;&#33218;&#25226;&#21253;&#35065;&#25235;&#21462;&#21040;&#26368;&#21512;&#36866;&#30340;&#20572;&#25918;&#28857;&#65292;&#26426;&#22120;&#20154;&#22312;&#25509;&#21040;&#20113;&#31471;&#30340;&#20449;&#24687;&#21518;&#65292;&#20250;&#20174;&#21462;&#36135;&#21475;&#21462;&#20986;&#21253;&#35065;&#65292;&#36865;&#36798;&#21040;&#29992;&#25143;&#25163;&#20013;&#12290;</p>\n<pstyle="text-align:left;"><spanstyle="border-bottom-color:orange;border-bottom-width:1px;border-bottom-style:solid;">&#20316;&#20026;&#26368;&#36148;&#36817;&#20154;&#20204;&#26085;&#24120;&#29983;&#27963;&#30340;&#20154;&#24037;&#26234;&#33021;&#65292;YOGO&#160;ROBOT&#30340;&#26234;&#33021;&#26411;&#31471;&#37197;&#36865;&#31449;&#29575;&#20808;&#23454;&#29616;&#20102;&#32676;&#20307;&#26234;&#33021;&#30340;&#31361;&#30772;&#65292;&#26426;&#22120;&#20154;&#12289;&#25968;&#25454;&#35843;&#24230;&#20013;&#24515;&#31561;&#22810;&#20010;&#26234;&#33021;&#20307;&#21487;&#20197;&#36890;&#36807;&#20113;&#31471;&#22823;&#33041;&#21644;&#26426;&#22120;&#20154;&#22823;&#33041;&#36827;&#34892;&#23545;&#35805;&#21644;&#20915;&#31574;&#65292;&#23454;&#29616;&#33258;&#20027;&#21327;&#21516;&#24037;&#20316;&#65292;&#26497;&#22823;&#25552;&#39640;&#20102;&#26411;&#31471;&#30340;&#37197;&#36865;&#25928;&#29575;&#12290;</span>&#19981;&#20165;&#22914;&#27492;&#65292;&#23427;&#36824;&#35774;&#35745;&#20102;&#26588;&#20307;&#33258;&#28040;&#27602;&#31995;&#32479;&#65292;&#38450;&#22841;&#25163;&#12289;&#38450;&#21387;&#33050;&#31561;&#23433;&#20840;&#20445;&#25252;&#65292;&#20445;&#38556;&#20102;&#29992;&#25143;&#30340;&#21462;&#29289;&#30340;&#23433;&#20840;&#12290;</p>\n<pstyle="text-align:left;">&#22312;&#19978;&#28023;&#38745;&#23433;&#30340;&#19968;&#22788;&#20889;&#23383;&#27004;&#22823;&#21381;&#37324;&#65292;&#19968;&#21040;&#21320;&#39640;&#23792;&#36865;&#39184;&#39640;&#23792;&#26399;&#65292;&#23601;&#26377;5&#20010;&#26426;&#22120;&#20154;&#22312;&#27004;&#23431;&#37324;&#31359;&#34892;&#36865;&#39184;&#65292;&#23427;&#20204;&#38543;&#30528;&#20154;&#32676;&#25380;&#20837;&#30005;&#26799;&#65292;&#33258;&#20027;&#21628;&#21483;&#30446;&#26631;&#27004;&#23618;&#65292;&#25226;&#22806;&#21334;&#36865;&#21040;&#23458;&#25143;&#25163;&#20013;&#12290;&#21363;&#20351;&#22312;&#20154;&#27969;&#23494;&#38598;&#30340;&#20154;&#32676;&#20013;&#31359;&#26797;&#65292;&#26426;&#22120;&#20154;&#20043;&#38388;&#20063;&#21487;&#20197;&#20114;&#30456;&#36991;&#35753;&#65292;&#21015;&#38431;&#21069;&#34892;&#12290;</p>\n<pstyle="text-align:left;">&#25454;&#30333;&#39046;&#23567;&#24352;&#20171;&#32461;&#65292;&#20182;&#20204;&#30340;&#20889;&#23383;&#27004;&#26377;2000&#22810;&#20301;&#30333;&#39046;&#65292;&#20294;&#21482;&#26377;3&#37096;&#30005;&#26799;&#65292;&#21320;&#39640;&#23792;&#25380;&#30005;&#26799;&#22570;&#27604;&#25380;&#39640;&#23792;&#22320;&#38081;&#12290;&#33258;&#20174;&#26377;&#20102;&#26426;&#22120;&#20154;&#65292;&#22806;&#21334;&#23601;&#21487;&#20197;&#8220;&#33258;&#24049;&#36865;&#19978;&#27004;&#20102;&#8221;&#12290;&#22905;&#24050;&#32463;&#20351;&#29992;&#26426;&#22120;&#20154;&#36865;&#39184;&#19977;&#20010;&#22810;&#26376;&#20102;&#65292;&#26426;&#22120;&#20154;&#20250;&#25552;&#21069;&#25171;&#30005;&#35805;&#25552;&#37266;&#22905;&#21462;&#39184;&#65292;&#27599;&#21333;&#22806;&#21334;&#30340;&#31561;&#24453;&#26102;&#38388;&#22823;&#32422;&#21482;&#26377;5&#20998;&#38047;&#12290;</p>\n<pstyle="text-align:left;">YOGOROBOT&#30340;&#25216;&#26415;&#36127;&#36131;&#20154;&#20313;&#31435;&#37995;&#21578;&#35785;&#35760;&#32773;&#65292;&#36825;&#22871;&#26411;&#31471;&#26234;&#33021;&#37197;&#36865;&#31995;&#32479;&#20973;&#20511;&#33258;&#20027;&#21487;&#25511;&#30340;&#23460;&#20869;<ahref="https://www.iyiou.com/t/wurenjiashi/"title="&#26080;&#20154;&#39550;&#39542;"target="_blank">&#26080;&#20154;&#39550;&#39542;</a>&#25216;&#26415;&#21644;&#20840;&#29699;&#39046;&#20808;&#30340;&#32676;&#20307;&#26234;&#33021;&#25216;&#26415;&#65292;&#22312;&#27004;&#23431;&#24418;&#25104;&#20102;&#19968;&#20010;&#39640;&#25928;&#30340;&#37197;&#36865;&#32593;&#32476;&#12290;&#20854;&#20013;&#26426;&#22120;&#20154;&#30340;&#23454;&#26102;&#20915;&#31574;&#36895;&#24230;&#24050;&#32463;&#20174;&#21407;&#20808;&#27599;&#31186;15&#27425;&#25552;&#21319;&#21040;100&#27425;&#65292;&#34892;&#36208;&#30340;&#26368;&#39640;&#36895;&#24230;&#36798;&#21040;2&#31859;&#27599;&#31186;&#65292;&#35299;&#20915;&#20102;&#26368;&#21518;&#19968;&#30334;&#31859;&#30340;&#37197;&#36865;&#23433;&#20840;&#21644;&#25928;&#29575;&#38382;&#39064;&#12290;</p>\n<pstyle="text-align:left;">YOGOROBOT&#30340;&#26234;&#33021;&#26411;&#31471;&#31995;&#32479;&#32463;&#21382;&#20102;&#20845;&#27425;&#36845;&#20195;&#65292;&#24456;&#22810;&#24615;&#33021;&#30340;&#31361;&#30772;&#34429;&#28982;&#30475;&#36215;&#26469;&#21482;&#26159;&#19968;&#20010;&#25968;&#23383;&#30340;&#21464;&#21270;&#65292;&#20294;&#26159;&#23427;&#32972;&#21518;&#28041;&#21450;&#20102;&#20108;&#21313;&#22810;&#20010;&#19981;&#21516;&#39046;&#22495;&#32508;&#21512;&#33021;&#21147;&#30340;&#31361;&#30772;&#65292;&#21253;&#25324;&#32467;&#26500;&#12289;&#30005;&#23376;&#12289;&#31639;&#27861;&#12289;&#36719;&#20214;&#31561;&#25972;&#20307;&#24615;&#33021;&#30340;&#25552;&#21319;&#12290;&#22312;&#20845;&#27425;&#36845;&#20195;&#30340;&#36807;&#31243;&#20013;&#65292;YOGOROBOT&#31215;&#32047;&#21457;&#34920;&#20154;&#24037;&#26234;&#33021;&#39046;&#22495;&#19987;&#21033;&#19977;&#30334;&#20313;&#39033;&#65292;&#23454;&#29616;&#20102;&#20174;&#30740;&#21457;&#21040;&#27979;&#35797;&#29983;&#20135;&#30340;&#20840;&#38142;&#36335;&#33258;&#30740;&#12290;</p>\n<h3style="text-align:left;">&#26032;&#32456;&#31471;&#36830;&#25509;&#26032;&#19994;&#24577;&#65292;&#37322;&#25918;<ahref="https://www.iyiou.com/t/zaixianjingji/"title="&#22312;&#32447;&#32463;&#27982;"target="_blank">&#22312;&#32447;&#32463;&#27982;</a>&#27963;&#21147;</h3>\n<pstyle="text-align:left;">&#31361;&#22914;&#20854;&#26469;&#30340;&#30123;&#24773;&#65292;&#32473;&#20154;&#20204;&#30340;&#29983;&#27963;&#24102;&#26469;&#20102;&#19968;&#31995;&#21015;&#30340;&#21464;&#21270;&#65292;&#20294;&#20063;&#34164;&#21547;&#26032;&#30340;&#26426;&#36935;&#12290;&#20854;&#20013;&#65292;&#20197;&#29983;&#40092;&#38646;&#21806;&#30005;&#21830;&#20026;&#20195;&#34920;&#30340;&#8220;&#22312;&#32447;&#32463;&#27982;&#8221;&#23637;&#29616;&#20986;&#24191;&#38420;&#21069;&#26223;&#12290;&#28040;&#36153;&#26041;&#24335;&#12289;&#29983;&#27963;&#26041;&#24335;&#30340;&#8220;&#22312;&#32447;&#8221;&#21270;&#65292;&#20652;&#29983;&#30528;&#19968;&#31995;&#21015;&#19982;&#20043;&#37197;&#22871;&#30340;&#22522;&#30784;&#35774;&#26045;&#24212;&#29992;&#32780;&#29983;&#65292;&#20174;&#32780;&#28949;&#21457;&#20986;&#34892;&#19994;&#26032;&#29983;&#26426;&#12290;</p>\n<pstyle="text-align:left;">YOGOROBOT&#30340;&#26234;&#33021;&#26411;&#31471;&#37197;&#36865;&#31995;&#32479;&#65292;&#34701;&#21512;&#20102;&#20154;&#24037;&#26234;&#33021;&#12289;5G&#12289;&#22823;&#25968;&#25454;&#31561;&#32508;&#21512;&#25216;&#26415;&#20248;&#21183;&#65292;&#20026;&#8220;&#22312;&#32447;&#32463;&#27982;&#8221;&#30340;&#21457;&#23637;&#25552;&#20379;&#20102;&#24212;&#29992;&#36733;&#20307;&#12290;YOGO&#160;ROBOT&#30340;&#32852;&#21512;&#21019;&#22987;&#20154;&#34081;&#26195;&#29614;&#35748;&#20026;&#65306;&#8220;&#26426;&#22120;&#20154;&#20135;&#21697;&#26368;&#26377;&#20215;&#20540;&#30340;&#26159;&#23427;&#33021;&#22815;&#38750;&#24120;&#26631;&#20934;&#21270;&#22320;&#21435;&#25552;&#20379;&#19968;&#20123;&#26381;&#21153;&#65292;&#21435;&#35299;&#20915;&#19968;&#20123;&#21171;&#21160;&#23494;&#38598;&#30340;&#38382;&#39064;&#12290;&#22312;&#29616;&#22312;&#36825;&#20010;&#38454;&#27573;&#65292;&#36825;&#26679;&#30340;&#26381;&#21153;&#26159;&#26356;&#34987;&#38656;&#35201;&#30340;&#12290;&#8221;</p>\n<pstyle="text-align:left;"><strong>&#26446;&#24378;&#20070;&#35760;&#25351;&#20986;&#65292;&#8220;&#22478;&#24066;&#26159;&#26368;&#22823;&#30340;&#24212;&#29992;&#22330;&#26223;&#65292;&#26159;&#20154;&#24037;&#26234;&#33021;&#25216;&#26415;&#30340;&#26368;&#20339;&#35797;&#39564;&#22330;&#12289;&#20215;&#20540;&#30340;&#26368;&#22909;&#23454;&#29616;&#22320;&#12290;&#8221;</strong><spanstyle="border-bottom-color:orange;border-bottom-width:1px;border-bottom-style:solid;">&#20316;&#20026;&#39318;&#25209;&#20837;&#36873;2020&#24180;&#19978;&#28023;&#21019;&#26032;&#20135;&#21697;&#30446;&#24405;&#30340;&#20154;&#24037;&#26234;&#33021;&#31995;&#32479;&#65292;YOGOROBOT&#26234;&#33021;&#26411;&#31471;&#37197;&#36865;&#31449;&#24050;&#32463;&#25104;&#20026;5G&#29575;&#20808;&#24212;&#29992;&#30340;&#26234;&#33021;&#32456;&#31471;&#65292;&#24182;&#25104;&#20026;&#26080;&#25509;&#35302;&#26381;&#21153;&#31185;&#25216;&#38450;&#30123;&#30340;&#31034;&#33539;&#12290;&#23427;&#20026;&#22330;&#26223;&#24102;&#26469;&#20840;&#26032;&#30340;&#31185;&#25216;&#21319;&#32423;&#65292;&#20063;&#22312;&#21161;&#21147;&#22478;&#24066;&#25171;&#36896;&#26356;&#32654;&#22909;&#30340;&#29983;&#27963;&#21697;&#36136;&#12290;</span></p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<pclass="copyrightState">\r\n\t\t\t\t\t\t\t\t\t\t<!--<i>&#29256;&#26435;&#22768;&#26126;</i>-->\r\n\t\t\t\t\t\t\t\t\t</p><pstyle="text-indent:32px;margin-top:0;"><spanstyle="color:#9b9b9b;">&#26412;&#25991;&#32463;&#25480;&#26435;&#21457;&#24067;&#65292;&#29256;&#26435;&#24402;&#21407;&#20316;&#32773;&#25152;&#26377;&#65307;&#20869;&#23481;&#20026;&#20316;&#32773;&#29420;&#31435;&#35266;&#28857;&#65292;&#19981;&#20195;&#34920;&#20159;&#27431;&#31435;&#22330;&#12290;&#22914;&#38656;&#36716;&#36733;&#35831;&#32852;&#31995;&#21407;&#20316;&#32773;&#12290;</span></p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t',
        # '<div id="post_thumbnail">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img class="aligncenter size-full" src="https://imgcache.iyiou.com/Cover/2017-08-26/qita-guangdong.jpg" alt="&#24191;&#19996;&#31185;&#25216;&#39302;,&#20154;&#24037;&#26234;&#33021;,&#24191;&#19996;&#30465;,&#20135;&#19994;&#38598;&#32676;,&#31908;&#28207;&#28595;&#22823;&#28286;&#21306;" style="width: 680px;height: auto;margin-bottom: 8px;">\r\n\r\n\t\t\t\t\t\t<div class="img_bottom">\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\t&#20316;&#32773;&#65306;&#20313;&#27427;&#23159;&#65292;&#22270;&#29255;&#26469;&#33258;&#8220;123rf.com.cn&#8221;\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t'
    ]
    print(filter_space_html(text_list=a))
